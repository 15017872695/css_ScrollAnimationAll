<!DOCTYPE html>
<html>
	<head runat="server">
		<meta name="format-detection" content="telephone=no,email=no,adress=no" />
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.0,user-scalable=no;" />
		<title></title>
		<!--CSS样式-->
		<link rel="stylesheet" href="css/index.css">
	</head>
	<body>
		<!-- 内容高度模拟盒子 -->
		<div class="nowBox">内容高度模拟盒子</div>

		<!-- 从暗到亮并显示相关文案动画效果  start-->
		<div class="box1">
			<span>哈苏相机 L2D-20c</span>
			<div class="box1_content">
				<!-- 遮罩 -->
				<div class="box1_mask"></div>
				<!-- 图片及文案 -->
				<div class="box1_imgBox">
					<img src="./img/1.jpg" alt="">
					<div class="imgBox_info">
						<span>4/3 CMOS</span>
						<span>哈苏相机</span>
					</div>
				</div>
			</div>
		</div>
		<!-- 从暗到亮并显示相关文案动画效果  end-->

		<!-- 滚动缩放并伴随暗度增强动画效果 start-->
		<div class="box2_scrollScale">
			<div class="sticky">
				<div class="children_left">
					<div>
						<span>5G操控</span>
						<p>通过5G网络大数据平台实现异地作业,高速率、低延时和大连接,提高作业效率。</p>
					</div>
					<div>
						<span>前后避障</span>
						<p>RT1搭配两个亳米波避障雷达，能识别≥3am的障碍物，在复杂的火场环境,确保无人机的飞行安全。</p>
					</div>
					<div>
						<span>RTK定位</span>
						<p>RT1采用双天线双模，RTK高精度差分定位仪，厘米级精度定位,确保无人机作业精准性。</p>
					</div>
					<div>
						<span>精准电控</span>
						<p>RT1搭视精准电控系统，配合三体高清MP摄像头，能在复杂环境中，远程控制开关。</p>
					</div>
					<div>
						<span>三冗余</span>
						<p>RT1采用行业飞控,RTK高精度定位。三冗余U,飞行更稳定。</p>
					</div>
					<div>
						<span>大容量可插拔电池</span>
						<p>RT1配备两块21700智能电池，可做到快速靥拔替换,应对各种工作环境。提高工作效率。</p>
					</div>
				</div>
			</div>
			<div class="nowSticky"></div>
		</div>
		<!-- 滚动缩放并伴随暗度增强动画效果 end-->

		<!-- 内容高度模拟盒子 -->
		<div class="nowBox">内容高度模拟盒子</div>
	</body>
</html>
<!--JS部分-->
<script src="http://www.jq22.com/jquery/jquery-1.10.2.js"></script>
<script src="./js/jQuery.positionSticky.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	$(function() {
		jQuery('.nowSticky').positionSticky();
		$(".box2_scrollScale").children()[1].remove();
		$('.nowSticky')[0].style.transition = "all .5s";
		$('.nowSticky')[0].style.top = "0px";
	})

	let box1Offset = ''
	let opacityValue = 0.8;
	let afterScrollTop = 0;
	let beforeScrollTop = document.documentElement.scrollTop // 记录开始滚动条高度
	let scaleValue = 1;

	window.addEventListener('scroll', (res) => {
		box1Offset = $('.box1').offset();
		afterScrollTop = document.documentElement.scrollTop;
		const delta = afterScrollTop - beforeScrollTop;
		start(delta > 0 ? "down" : "up")
		beforeScrollTop = afterScrollTop; //请勿将该变量赋值顺序颠倒，否则将会出现监听错乱问题
		scrollScale(delta > 0 ? "down" : "up")
	})

	/* 从暗到亮并显示相关文案动画 滚动事件  start*/
	function start(delta) {
		if (delta == 'down') { // 向下滚动
			if (afterScrollTop >= (box1Offset['top'] - 150)) {
				opacityValue = (opacityValue - 0.03) <= 0 ? 0 : (opacityValue - 0.03);
				$('.box1_mask').css('opacity', opacityValue);
			}
		} else if (delta == 'up') { //向上滚动
			if ((box1Offset['top'] - afterScrollTop) > 50) {
				opacityValue = (opacityValue + 0.03) >= 0.9 ? 0.9 : (opacityValue + 0.03);
				$('.box1_mask').css('opacity', opacityValue);
			}
		}
		opacityValue < 0.7 ? $('.imgBox_info').css('opacity', 1) : $('.imgBox_info').css('opacity', 0)
	}
	/* 从暗到亮并显示相关文案动画 滚动事件  end*/


	/* 滚动缩放并伴随暗度增强动画 滚动事件  start*/
	function scrollScale(delta) {
		if ($('.nowSticky')[0].style.position == 'fixed' && delta == 'down') {
			// console.log('down')
			if (scaleValue > 0 && scaleValue <= 2) {
				scaleValue += 0.008;
				$('.nowSticky').css('transform', `scale(${scaleValue})`)
			}
		} else if ($('.nowSticky')[0].style.position == 'fixed' && delta == 'up') {
			// console.log('up')
			if (scaleValue >= 1) {
				scaleValue -= 0.008;
				$('.nowSticky').css('transform', `scale(${scaleValue})`)
			}
		}
	}
	/* 滚动缩放并伴随暗度增强动画 滚动事件  end*/
</script>
